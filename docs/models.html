<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Models | March Madness Machine Learning 2022</title>
  <meta name="description" content="Chapter 4 Models | March Madness Machine Learning 2022" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Models | March Madness Machine Learning 2022" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Models | March Madness Machine Learning 2022" />
  
  
  

<meta name="author" content="Connor Folk" />


<meta name="date" content="2022-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="variable-selection.html"/>
<link rel="next" href="the-pool-of-tears.html"/>
<script src="libs/header-attrs-2.12/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">March Madness 2022</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview<span></span></a></li>
<li class="chapter" data-level="2" data-path="dataset.html"><a href="dataset.html"><i class="fa fa-check"></i><b>2</b> Dataset<span></span></a></li>
<li class="chapter" data-level="3" data-path="variable-selection.html"><a href="variable-selection.html"><i class="fa fa-check"></i><b>3</b> Variable Selection<span></span></a></li>
<li class="chapter" data-level="4" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>4</b> Models<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="models.html"><a href="models.html#xgboost"><i class="fa fa-check"></i><b>4.1</b> XGBoost<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="models.html"><a href="models.html#methodology-and-analysis"><i class="fa fa-check"></i><b>4.1.1</b> Methodology and Analysis<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="models.html"><a href="models.html#results"><i class="fa fa-check"></i><b>4.1.2</b> Results<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="models.html"><a href="models.html#random-forest-model"><i class="fa fa-check"></i><b>4.2</b> Random Forest Model<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="models.html"><a href="models.html#methodology-and-analysis-1"><i class="fa fa-check"></i><b>4.2.1</b> Methodology and Analysis<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="models.html"><a href="models.html#results-1"><i class="fa fa-check"></i><b>4.2.2</b> Results<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-pool-of-tears.html"><a href="the-pool-of-tears.html"><i class="fa fa-check"></i><b>5</b> The pool of tears<span></span></a></li>
<li class="chapter" data-level="6" data-path="a-caucus-race-and-a-long-tale.html"><a href="a-caucus-race-and-a-long-tale.html"><i class="fa fa-check"></i><b>6</b> A caucus-race and a long tale<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">March Madness Machine Learning 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="models" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Models<a href="models.html#models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>After data cleaning and variable selection, I created different models, including logistic regression, xgboost, random forest, and neural networks and scored them based on area under the ROC curve (AROC) and misclassification rate. AROC showed the models performance across different cutoffs, which may not seem useful since the cutoff should be .5. However, this metric allowed me to asses the overall performance of the model, not just classification. The three best models were an xgboost model, a random forest model, and a neural net model.</p>
<div id="xgboost" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> XGBoost<a href="models.html#xgboost" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="methodology-and-analysis" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Methodology and Analysis<a href="models.html#methodology-and-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to create this model, I had to turn the parameters to the dataset. I used 30-fold cross validation to pick the parameters that resulted in the lowest amount of error and prevented overfitting. However, this model still overfit the training data. The ROC curve and Confusion Matrix for this model on the training data is shown below. The model does extradinarily well with a AROC of .94 and misclassification rate of —-.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre><code>##     0   1
## 0 322  43
## 1  42 321</code></pre>
<p>The model also calculates the importance of each variable in predicting which team wins. The variables are clustered based on importance to the model, with cluster 1 in red and cluster 2 in light blue. The two most important variables were the Pomeroy rankings for the two teams. The plot of Variable Importance is shown below.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="results" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Results<a href="models.html#results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Even though the model performed extremely well on the training set, it does not perform as well on the validation dataset (2019 and 2021 seasons) compared to the training dataset furthering the evidence that the model is overfitted However, the model performs very well on the 2019 NCAA tournament compared to other models I created, predicting about 76% of the games correctly. However, the model performs extremely poorly on the 2021 NCAA tournament, predicting only 63% of games correctly.</p>
<p>____ Insert Comparisons Here</p>
</div>
</div>
<div id="random-forest-model" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Random Forest Model<a href="models.html#random-forest-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="methodology-and-analysis-1" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Methodology and Analysis<a href="models.html#methodology-and-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Random Forest model was tuned similarly to the xgboost model using cross-validation. This model performed worse than the xgboost model on the training set, but more in line with model scores on the validation datasets. The AROC for the random forest .75 and the misclassification rate was —-. The area under the ROC curve and Confusion matrix are shown below.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre><code>##     0   1
## 0 246 109
## 1 118 255</code></pre>
<p>The random forest model also displays the most important variables in determining the winning team. A table of the most important variables to the model based on change in accuracy and impurity are shown below. This table also shows the Pomeroy rankings for both teams are the most influential in determining the winner.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="results-1" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Results<a href="models.html#results-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The random forest model had similar performance on the 2019 NCAA tournament compared to the training. The model predicted 73% of the games correctly during this tournament with an AROC of .7963. The model performed worse on the 2021 tournament with a classification rate of 65% and an AROC of .714. The table below shows the model performance on the two tournaments —–</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="variable-selection.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-pool-of-tears.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ConnorFolk/MarchMadness2022/edit/master/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ConnorFolk/MarchMadness2022/blob/master/index.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
